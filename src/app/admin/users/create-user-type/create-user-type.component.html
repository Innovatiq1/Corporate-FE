<section class="content">
    <div class="content-block">
        <div class="block-header" *ngFor="let breadscrum of breadscrums">
            <app-breadcrumb [title]="breadscrum.title" [items]="breadscrum.items" [active_item]="breadscrum.active">
            </app-breadcrumb>
        </div>
        <div class="row clearfix">
            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                <div class="card">
                    <div class="header">
                    </div>
                    <form [formGroup]="userTypeFormGroup">
                        <div class="body m-4">
                            <div class="row">
                                <div  *ngIf ="isEdit === false"class="col-xl-4 col-lg-5 col-md-10 col-sm-12 mb-2">
                                    <label>Existing Roles</label>
                                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                                        <mat-select formControlName="typeName">
                                            <mat-option *ngFor="let type of userTypeNames" [value]="type.typeName">
                                                {{ type?.typeName | titlecase }}
                                              </mat-option>
                                          </mat-select>
                                    </mat-form-field>
                                </div>
                              </div>
                            <div *ngIf ="isEdit === true" >
                                <div class="row">
                                    <div class="col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-2">
                                        <label>Role</label>
                                        <mat-form-field class="example-full-width mb-3" appearance="outline">
                                            <input matInput type="text" formControlName="typeName"
                                            class="form-control" placeholder="Enter New User Role">                                      
                                        </mat-form-field>
                                    </div>
                                    <div class="col-8">
                                            <div class="card-container">
                                              <button *ngIf="this.data?.status == 'active'"  mat-menu-item (click)="changeInActive(this.data)">
                                                <app-feather-icons [icon]="'trash-2'" [class]="'tbl-fav-delete'"></app-feather-icons>
                                                <span class="menu-text px-3">Inactive</span>
                                              </button>
                                              <button class="align-items-center" alt="Delete" *ngIf="this.data?.status == 'inactive'" mat-menu-item (click)="changeActive(this.data)">
                                                <img class="img-w" src="/assets/approve.svg" alt="approve">
                                                <span class="menu-text">Active</span>
                                              </button>
                                              <button mat-menu-item (click)="delete(this.data)"  >
                                                    <app-feather-icons [icon]="'trash-2'" [class]="'tbl-fav-delete'"></app-feather-icons>
                                                    <span class="menu-text px-3">Delete</span>
                                                </button>
                                          </div>
                                </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <hr>
                        <div class="row ms-5">
                            <div class="col fs-5 fw-semibold">Module</div>
                            <div class="col fs-5 fw-semibold">Sub Module</div>
                            <div class="col fs-5 fw-semibold">Module Access</div>
                        </div>
                        <div class="row border-bottom p-4" *ngFor="let menu of dataSource.data">
                            
                            <div class="col-md ">
                                <mat-checkbox class="example-margin mt-1" [(ngModel)]="menu.checked"
                                    (change)="changeMenuChecked(menu.checked, menu?.id)"
                                    [indeterminate]="menu.indeterminate">
                                    <h6 style="padding-top: 10px;font-weight: bolder;">{{menu?.title | json}}</h6>
                                </mat-checkbox>
                            </div>
                            <div class="col-md">
                                <div *ngFor="let submenu of menu.children" class="sub-menu">
                                    <mat-checkbox class="example-margin" [(ngModel)]="submenu.checked"
                                        (change)="changeMenuChecked(submenu.checked, submenu.id)"
                                        [indeterminate]="submenu.indeterminate">
                                        <p class="menu">{{submenu?.title}}</p>
                                    </mat-checkbox>

                                    <!-- <div *ngFor="let action of submenu.children" class="sub-menu">
                                        <mat-checkbox class="example-margin" [(ngModel)]="action.checked">
                                            <p class="menu">{{ action.title }}</p>
                                        </mat-checkbox>
                                    </div> -->
                                </div>
                            </div>

                            <div class="col-md">
                                <div *ngFor="let submenu of menu.children" class="sub-menu">
                                    <!-- <mat-checkbox class="example-margin" [(ngModel)]="submenu.checked"
                                        (change)="changeMenuChecked(submenu.checked, submenu.id)"
                                        [indeterminate]="submenu.indeterminate">
                                        <p class="menu">{{submenu?.title}}</p>
                                    </mat-checkbox> -->

                                    <div *ngFor="let action of submenu.children | arrayFilter:false" class="sub-menu">
                                        <mat-checkbox class="example-margin" [(ngModel)]="action.checked">
                                            <p class="menu">{{ action.title }}</p>
                                        </mat-checkbox>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <div class="d-flex justify-content-between m-5">
                        <button class="btn px-4" mat-raised-button id="back" [routerLink]="['/student/settings/user-type']">Back</button>
                        <button mat-raised-button id="submit" (click)="onSubmitForm()">{{isEdit? 'Update':'Create'}}</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>